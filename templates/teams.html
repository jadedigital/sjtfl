$def with (teamid, teamsdb, standingsdb, scheduledb, scheduledb2, statsdb, teams_list)
$var scheduled = scheduledb.list()
$var teamsd = teamsdb.list()
$var active_nav = "teams"

$ team_id = collections.defaultdict(int)

$for team in teams_list:
  $ team_id[team.shortname] = team.id
   
<div class="container">
  <div class="page-header">
    <div class="sponsor">$standingsdb.name.replace(standingsdb.shortname, '')</div>
    <div class="team-name">$standingsdb.shortname<small> ($standingsdb.wins - $standingsdb.losses - $standingsdb.ties)</small></div>
    $ t = standingsdb.shortname
  </div>
  <ul class="nav nav-pills nav-stats" role="tablist">
    <li class="active"><a href="#roster" role="tab" data-toggle="tab">Roster</a></li>
    <li><a href="#schedule" role="tab" data-toggle="tab">Schedule</a></li>
  </ul>

    <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane fade in active" id="roster">
      <div class="row">
        <div class="col-md-3"></div>
        <div class="col-md-6">
          <div class="panel panel-primary">
            <div class="panel-heading text-center">Team Stats</div>
            <div class="table-responsive">
              <table class="table table-striped table-hover table-condensed">
                <tr>
                <th class="text-center col-md-5">Player</th>
                <th class="text-center col-md-1"> GP </th>
                <th class="text-center col-md-1">PTS </th>
                <th class="text-center col-md-1">SCKS</th>
                <th class="text-center col-md-1">INTS</th>
                <th class="text-center col-md-1">TDP </th>
              </tr>
              $for stats in statsdb:
                $ points = stats.touchdowns * 6 + stats.oneconvert + stats.twoconvert * 2 + stats.rouge + stats.safety * 2
                <tr>
                  <td class="text-center"><h5>$stats.firstname $stats.lastname</h5></td>
                  <td class="text-center">$stats.gameplayed</td>
                  <td class="text-center">$points</td>
                  <td class="text-center">$stats.sack</td>
                  <td class="text-center">$stats.interception</td>
                  <td class="text-center">$stats.tdpass</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <div class="col-md-3"></div>
      </div>
    </div>
    
    <div class="tab-pane fade" id="schedule">
      <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
          <div class="panel panel-primary text-center">
            <div class="panel-heading">Game Schedule</div>
            <div class="table-responsive">
              <table class="table table-striped table-hover table-condensed">
              
                <tr>
                  <th colspan="3" class="text-center col-xs-6">Score</th>
                  <th class="text-center col-xs-6">Date</th>
                </tr>
                $for schedule in scheduledb2:
                  $if schedule.team1 == t:
                    <tr>
                      <td class="text-right col-xs-2"><h5>$schedule.team1</h5></td>
                      $if schedule.team1score is None:
                        <td class="text-center col-xs-2"><strong><a class="team_link" href="/preview?gameid=$schedule.gameid">vs</a></strong></td>
                      $else:
                        <td class="text-center col-xs-2"><strong>$schedule.team1score - $schedule.team2score</strong></td>
                      <td class="text-left col-xs-2"><h5><a class="team_link" href="/teams?teamid=$team_id[schedule.team2]">$schedule.team2</a></h5></td>
                      <td class="text-center col-xs-6">$schedule.date.strftime('%A, %B %d, %Y') - $schedule.time.strftime('%I:%M %p')</td>
                    </tr>
                  $if schedule.team2 == t:
                    <tr>
                      <td class="text-right col-xs-2"><h5>$schedule.team2</h5></td>
                      $if schedule.team2score is None:
                        <td class="text-center col-xs-2"><strong><a class="team_link" href="/preview?gameid=$schedule.gameid">vs</a></strong></td>
                      $else:
                        <td class="text-center col-xs-2"><strong>$schedule.team2score - $schedule.team1score</strong></td>
                      <td class="text-left col-xs-2"><h5><a class="team_link" href="/teams?teamid=$team_id[schedule.team1]">$schedule.team1</a></h5></td>
                      <td class="text-center col-xs-6">$schedule.date.strftime('%A, %B %d, %Y') - $schedule.time.strftime('%I:%M %p')</td>
                    </tr>
              </table>
            </div>
          </div>
          <div class="panel panel-primary text-center">
            <div class="panel-heading">Lines Schedule</div>
            <div class="table-responsive">
              <table class="table table-striped table-hover table-condensed">
                <tr>
                  <th colspan="3" class="text-center col-xs-6">Score</th>
                  <th class="text-center col-xs-6">Date</th>
                </tr>
                $for schedule in scheduledb2:
                  $if schedule.teamlines == t:
                    <tr>
                      <td class="text-right col-xs-2"><h5><a class="team_link" href="/teams?teamid=$team_id[schedule.team1]">$schedule.team1</a></h5></td>
                      $if schedule.team1score is None:
                        <td class="text-center col-xs-2"><strong><a class="team_link" href="/preview?gameid=$schedule.gameid">vs</a></strong></td>
                      $else:
                        <td class="text-center col-xs-2"><strong>$schedule.team1score - $schedule.team2score</strong></td>
                      <td class="text-left col-xs-2"><h5><a class="team_link" href="/teams?teamid=$team_id[schedule.team2]">$schedule.team2</a></h5></td>
                      <td class="text-center col-xs-6">$schedule.date.strftime('%A, %B %d, %Y') - $schedule.time.strftime('%I:%M %p')</td>
                    </tr>
              </table>
            </div>
          </div>
        </div>
        <div class="col-md-2"></div>
      </div>
    </div>
  </div>
  <br>
  <hr>
  <br>
</div>